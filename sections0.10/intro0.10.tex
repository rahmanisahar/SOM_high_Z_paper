% Referee comments:
%1a. The authors state (in their response, but not in the paper) that there is no known correct classification for these galaxies.  Please add this necessary context for the paper.  This positions the work in the world of of (semi-) supervision, since correct labels are not available.

%1b. The use of the chi-squared template assignment needs to be clearly explained and justified.  The author response states that this is a common method employed in the research community.  This too should be added to the paper to justify why it was chosen as a reference point (ideally with references to show its common usage by others).

%1c. If chi-squared minimization is the current most widely used method, then the paper needs to make a strong case for why to bother using a different method (SOMs) that only imperfectly approximates (i.e., does not have 100% agreement with) the chi-squared method.  I expect that the benefit is obtaining the insights provided from the analysis of the trained SOM structure, which cannot be achieved with the chi-squared method.  Make this explicit (up front, in the Introduction) so the reader understands why they might want to bother using this new method instead of chi-squared.

\section{Introduction}
\label{sec: intro_somz}


Nearly all information we can obtain from a galaxy is encapsulated in the light it emits; every observable phenomenon in a galaxy leaves a footprint on its spectral energy distribution (SED).
We can determine some physical properties of a galaxy by properly modeling various features observed in its SED, and the general shape of the SED can be used as an identifier of the morphological type.
Considering the main features of SEDs, galaxies can be categorized into two main groups: quiescent or star-forming.
Each group has its own characteristic features and can in turn be divided into many sub-branches.


Several attempts have been made to create a complete set of templates for categorizing the spectral type of galaxies using observations of nearby galaxies~(e.g.~\citealt{Kinney93}, \citealt[][hereafter \citetalias{Kinney96}]{Kinney96}, \citealt{Bershady00}, \citealt{Mannucci01}). 
Based on their usage, these templates are restricted to certain wavelengths.
In the near-infrared (NIR) to ultraviolet (UV) wavelengths (the region where the energy output of stars peaks), the spectrum\footnote{In the remainder of this paper, we are concerned with a limited range in wavelength, and so we refer to spectra rather than spectral energy distributions.} contains information about the main physical properties of galaxies, e.g., age, star formation rate (SFR), stellar mass, metallicity, and interstellar medium. 
Using templates to classify galaxy spectra can help to answer the question of whether galaxy spectra form a continuous distribution or can  be separated into discrete groups.
Templates are also helpful in computing $K$-corrections and discovering new classes of objects as outliers \citep{Folkes96}.


Advances in techniques and detectors have resulted in more detailed observations and also made classification of galaxies more complex.
Since no two galaxies, even with the same morphology, have exactly the same properties, classifying spectra of galaxies using templates is very challenging.
To overcome this challenge, many fitting methods have been developed and used to find template matches for spectra, with $\chi^2$ minimization being the most commonly used. 
Artificial neural networks, K-means clustering, and principal component analysis are some other methods used to cluster and classify spectral types of galaxies \citep[e.g.][]{Allen13,Ordov14,Shi15}.

Neural networks can be trained using two methods: supervised and unsupervised.
In supervised methods, a neural network is trained using input data based on a desired outcome.
These methods are very useful for classification of data with specific target values.
In unsupervised methods there is no prediction of output:
these methods classify data based on their underlying structures and hidden patterns.
Unsupervised methods are very helpful in obtaining knowledge from the data, or when the underlying structure of the data is not well established.
A Kohonen self-organizing map (also called self-organizing map, or SOM) is a (semi)-supervised neural network.


The goal of this work is to investigate the use of self-organizing maps in classifying galaxy spectra against templates, and compare them to other methods. 
The questions we want to answer are: 
(1) What is the degree of agreement between classifications produced by $\chi^2$ fitting, one- and two-dimensional self-organizing maps, K-means clustering and artificial neural networks? 
(2) Are certain spectral types more (or less) consistently classified by the different methods? 
(3) Which classification methods produce classes with the highest internal similarity ?
We analyze the same sample of 142 galaxies with $0.5 < z < 1$ as 
\citet[][hereafter \citetalias{Hossein12}]{Hossein12}, who classified the spectra using a supervised (multi-layer feed-forward) neural network method with the \citetalias{Kinney96} templates.
For each of the 142 galaxies, we find the best chi-squared fit among the 12 templates to use as a base for comparing the methods' performance.
We compute an agreement score for each method and also use the Fleiss Kappa index \citep{Fleiss71} to test interrater reliability 
between the methods.
To measure how well each classification method groups similar objects together, we
calculate the silhouette scores and dispersions in properties between galaxies classified in the same groups.


This paper is organized as follows.
In Section~\ref{sec: data_highZ}, we present the data used to train the networks and the data classified using the trained networks. 
We describe the SOM and K-means clustering methods in Section~\ref{sec: method_somz}. 
The results of the spectral classifications and comparison with previous studies are presented in Section~\ref{sec: result}. 
In Section~\ref{sec: summary_SOMZ}, we summarize our results and discuss potential future work in this subject.